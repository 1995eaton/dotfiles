execute pathogen#infect()

" Color schemes
set t_Co=256
" let g:rehash256=1
" colorscheme molokai

" File settings
filetype plugin indent on
" au BufReadPost * call vimcomplete#init()
set fileformats=unix,dos,mac

" Syntax hightlighting
syntax on
nnoremap <silent> <C-h> :nohlsearch<CR>
colorscheme mine


" Line numbering
" set relativenumber
set number
set cursorline

" Cursor movement
set mouse=nicr
nnoremap j gj
nnoremap k gk
nnoremap 0 g^
nnoremap $ g$
nnoremap <silent> <C-j> :bn<CR>
nnoremap <silent> <C-K> :bN<CR>
nnoremap J jzz
nnoremap K kzz
vnoremap K k
vnoremap J j
map L zz

" Disable line breaks unless the <Enter> key is hit
set wrap
set linebreak
set nolist
set textwidth=0
set wrapmargin=0

" Normal backspace behavior (non-Vi)
set backspace=2

" Tab settings
set smarttab
set tabstop=2
set shiftwidth=2
set expandtab

" Searching
set incsearch
set hlsearch
set ignorecase
set smartcase
set magic

" Reload vimrc
nmap <silent> <leader>r :so ~/.vimrc<cr>

" Vim comments
nmap ge gac
vmap ge ga

" Copy/Paste to/from X buffer
vnoremap gy "+y
vnoremap gd "+d
vnoremap gc "+c
nnoremap gC "+C
nnoremap gcc "+cc
nnoremap gD "+D
nnoremap gd "+d
nnoremap gy "+y
nnoremap <C-y> :%y+"<cr>
nnoremap gp "+p
vnoremap gp "+p

" Bracket highlighting
set showmatch
set matchtime=2

" Disable file backups + swapfile creation
set noswapfile
set nobackup
set nowb

" Command mode settings
set wildmenu
set wildmode=longest:list,full
set shellslash
set history=100

" Syntastic
nnoremap <C-s> :SyntasticToggleMode<CR>
let g:syntastic_javascript_checkers = ['jshint']
hi SpellCap term=reverse ctermbg=160

" Airline
set laststatus=2
let g:airline_theme='molokai'
let g:airline_left_sep=''
let g:airline_right_sep=''
let g:tcommentMapLeaderOp1="ga"
map <C-t> :tabnew<CR>:Explore<CR>
map <A-q> :q<CR>
map <C-S-q> :q!<CR>

" Miscellaneous
vnoremap . :normal .<CR>
set expandtab
set visualbell t_vb=
set ttimeoutlen=0
set ttyfast
set timeoutlen=500
set lazyredraw
vnoremap <C-e> <C-u>
nnoremap <C-e> <C-u>
let g:run_fifo = "/tmp/vim-run_fifo"
let g:run_exec_on_write = 1

" Mappings
nnoremap Q @q
nnoremap @@ @q
vmap gq ygvge
nmap gqq yyge
set nofoldenable
nnoremap ' `
nnoremap ` '
nnoremap '' ``zz
nnoremap `` ``zz
vnoremap < <gv
vnoremap > >gv
let loaded_matchparen = 1
nnoremap <C-p> :SyntasticToggleMode<CR>
inoremap <C-e> <C-o>:NeoCompleteToggle<CR>
nnoremap go mto<Esc>`t
nnoremap gO mtO<Esc>`t
vnoremap ab :normal Va{o^<CR>
vmap ib :normal Va{o0<CR>
omap <silent> ab :normal Vab<CR>
omap <silent> ib i{<CR>
cnoremap <C-a> <C-b>
cnoremap <C-b> <Left>
cnoremap <C-f> <Right>
nnoremap <silent> <C-f> :call ToggleLineMax()<CR>
inoremap <silent> <C-f> <C-o>:call ToggleLineMax()<CR>


map <F10> :echo "hi<" . synIDattr(synID(line("."),col("."),1),"name") . '> trans<'
      \ . synIDattr(synID(line("."),col("."),0),"name") . "> lo<"
      \ . synIDattr(synIDtrans(synID(line("."),col("."),1)),"name") . ">"<CR>
let g:syntastic_cpp_compiler = 'g++'
let g:syntastic_cpp_compiler_options = ' -std=c++14'
hi CursorLine ctermbg=233
hi CursorLineNr ctermbg=233

" GUI options
if has('gui_running')
  set guifont=DejaVu\ Sans\ Mono\ 10
  autocmd GUIEnter * set vb t_vb=
  autocmd VimEnter * set vb t_vb=
  colorscheme molokai
  set laststatus=0
  set guioptions-=T
  set guioptions-=e
  set guioptions-=r
  set guioptions-=m
  set guioptions+=m
endif

func! HighlightInstances()
  let @/ = expand("<cword>")
  set hlsearch
endfunc
nnoremap <silent> <C-l> :set nohlsearch\|:call HighlightInstances()<CR>

hi LineMax cterm=none
match LineMax /\%81v.*/
let s:line_max_enabled = 0
func ToggleLineMax()
  let s:line_max_enabled = !s:line_max_enabled
  if s:line_max_enabled
    " hi LineMax cterm=reverse
    hi LineMax cterm=underline
  else
    hi clear LineMax
  endif
endfunc
call ToggleLineMax()

au BufRead,BufNewFile *.md set filetype=markdown
au BufRead,BufNewFile *.peg,*.jison set ft=javascript
au FileType python set ts=2 sw=2
" au Filetype java setlocal omnifunc=javacomplete#Complete
" au BufRead,BufNewFile *.java call javacomplete#SetSourcePath('.')
" au BufRead,BufNewFile *.java call javacomplete#AddClassPath('/home/jake/.java8-src/out')

" Neocomplete
let g:acp_enableAtStartup = 0
let g:neocomplete#auto_completion_start_length=2
let g:neocomplete#force_overwrite_completefunc=0
let g:neocomplete#max_keyword_width=80
let g:neocomplete#sources#tags#cache_limit_size=5000000
let g:neocomplete#enable_at_startup = 1
let g:neocomplete#enable_smart_case = 0
let g:neocomplete#sources#syntax#min_keyword_length = 2
let g:neocomplete#lock_buffer_name_pattern = '\*ku\*'
function! s:my_cr_function()
  return neocomplete#close_popup() . "\<CR>"
endfunction
inoremap <silent> <CR> <C-r>=<SID>my_cr_function()<CR>
inoremap <expr><TAB>  pumvisible() ? "\<C-n>" : "\<TAB>"
inoremap <expr><S-TAB>  pumvisible() ? "\<C-p>" : "\<S-TAB>"
autocmd FileType css setlocal omnifunc=csscomplete#CompleteCSS
autocmd FileType html,markdown setlocal omnifunc=htmlcomplete#CompleteTags
autocmd FileType javascript setlocal omnifunc=js#CompleteJS
autocmd FileType python setlocal omnifunc=pythoncomplete#Complete
autocmd FileType xml setlocal omnifunc=xmlcomplete#CompleteTags
if !exists('g:neocomplete#keyword_patterns')
    let g:neocomplete#keyword_patterns = {}
endif
let g:neocomplete#keyword_patterns['default'] = '\h\w*'
if !exists('g:neocomplete#sources#omni#input_patterns')
  let g:neocomplete#sources#omni#input_patterns = {}
endif
let g:neocomplete#sources#omni#input_patterns.javascript = '[a-zA-Z_$]\{3,}\|\.[a-zA-Z_$]*'
set pumheight=8
set completeopt=menu

let g:syntastic_java_javac_config_file_enabled = 1
let g:syntastic_java_javac_config_file = '/home/jake/.syntastic_javac_config'
silent
let g:Omnisharp_start_server = 0
au FileType cs setlocal cinoptions+=j1,J1
